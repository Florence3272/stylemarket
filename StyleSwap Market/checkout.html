<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç»“ç®—ä¸æ”¯ä»˜ - æœè£…ç®¡ç†ç³»ç»Ÿ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-bg: #FAF9F6;
      --accent-coral: #FF6B6B;
      --accent-blue: #4ECDC4;
      --text-dark: #2C3E50;
      --light-pink: #FFE5E5;
      --light-mint: #E8F8F5;
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family:'Inter',sans-serif;
      background:var(--primary-bg);
      color:var(--text-dark);
      min-height:100vh;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    a{text-decoration:none;color:inherit;}

    /* ----- é¡¶éƒ¨å¯¼èˆª ----- */
    .navbar{
      position:sticky;
      top:0;
      z-index:50;
      backdrop-filter:blur(12px);
      background:rgba(255,255,255,.25);
      border-bottom:1px solid rgba(255,255,255,.2);
    }
    .navbar-inner{
      max-width:80rem;
      margin:0 auto;
      padding:.75rem 1.5rem;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .logo{font-size:1.25rem;font-weight:600;letter-spacing:.05em;}
    .nav-links{display:flex;gap:1.5rem;font-size:.875rem;}
    .nav-links a{transition:color .3s;}
    .nav-links a:hover,
    .nav-links a.active{color:var(--accent-coral);}

    /* ----- ä¸»å®¹å™¨ ----- */
    .container{
      max-width:64rem;
      margin:0 auto;
      padding:3rem 1.5rem 4rem;
    }
    .page-title{
      font-family:'Playfair Display',serif;
      font-size:2rem;
      font-weight:600;
      text-align:center;
      margin-bottom:2.5rem;
    }

    /* ----- ç»ç’ƒå¡ç‰‡ ----- */
    .glass-card{
      background:rgba(255,255,255,.3);
      backdrop-filter:blur(15px);
      border-radius:20px;
      padding:1.5rem 2rem;
      border:1px solid rgba(255,255,255,.2);
      margin-bottom:2rem;
    }
    .glass-card h3{
      font-weight:600;
      margin-bottom:1rem;
    }

    /* ----- è¡¨å• ----- */
    .form-grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:1rem;
    }
    @media(max-width:768px){.form-grid{grid-template-columns:1fr;}}
    .form-group{ display:flex;flex-direction:column; }
    .form-group.full{ grid-column:1/-1; }
    .form-label{
      font-size:.875rem;
      margin-bottom:.25rem;
      opacity:.8;
    }
    .form-input{
      padding:.5rem .75rem;
      border-radius:12px;
      border:1px solid rgba(44,62,80,.15);
      background:rgba(255,255,255,.5);
      transition:all .3s;
    }
    .form-input:focus{
      outline:none;
      border-color:var(--accent-blue);
      background:#fff;
    }

    /* ----- ä¼˜æƒ åˆ¸é€‰æ‹©å™¨ ----- */
    .coupon-selector{
      margin-top:1rem;
    }
    .coupon-radio{
      display:flex;
      align-items:center;
      gap:.75rem;
      padding:.75rem;
      margin-bottom:.5rem;
      background:rgba(255,255,255,.4);
      border-radius:12px;
      border:1px solid rgba(255,255,255,.5);
      cursor:pointer;
      transition:all .3s;
    }
    .coupon-radio:hover{
      border-color:var(--accent-coral);
    }
    .coupon-radio input{
      margin:0;
    }
    .coupon-info{
      flex:1;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .coupon-name{
      font-weight:500;
    }
    .coupon-discount{
      color:var(--accent-coral);
      font-weight:600;
    }

    /* ----- è®¢å•æ‘˜è¦ ----- */
    .order-item{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:.75rem 0;
      border-bottom:1px solid rgba(44,62,80,.08);
    }
    .order-item:last-child{border-bottom:none;}
    .order-total{
      text-align:right;
      margin-top:1rem;
      font-size:1.25rem;
      font-weight:600;
    }
    .total-price{
      background:linear-gradient(135deg,var(--accent-coral),var(--accent-blue));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }

    /* ----- æŒ‰é’® ----- */
    .btn-primary{
      padding:.75rem 2rem;
      border-radius:14px;
      border:none;
      font-weight:600;
      cursor:pointer;
      background:linear-gradient(135deg,var(--accent-coral),var(--accent-blue));
      color:#fff;
      box-shadow:0 8px 20px rgba(78,205,196,.25);
      transition:all .3s;
    }
    .btn-primary:hover{
      box-shadow:0 10px 28px rgba(78,205,196,.4);
    }
    .btn-center{
      display:flex;
      justify-content:center;
      margin-top:2rem;
    }

    /* ----- é¡µè„š ----- */
    .footer{
      text-align:center;
      padding:1.5rem 0;
      font-size:.75rem;
      color:var(--text-dark);
      opacity:.5;
      backdrop-filter:blur(12px);
      background:rgba(255,255,255,.2);
      border-top:1px solid rgba(255,255,255,.2);
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header class="navbar">
    <div class="navbar-inner">
      <div class="logo">æœè£…ç®¡ç†ç³»ç»Ÿ</div>
      <nav class="nav-links">
        <a href="index.html">æ­é…æ¨¡æ‹Ÿ</a>
        <a href="history.html" class="active">æˆ‘çš„æ­é…</a>
        <a href="cart.html">è´­ç‰©è½¦</a>
        <a href="checkout.html">ç»“ç®—</a>
        <a href="order.html">æˆ‘çš„è®¢å•</a>
        <a href="about.html">å…³äºç³»ç»Ÿ</a>
      </nav>
    </div>
  </header>

  <!-- ä¸»ä½“ -->
  <main class="container">
    <h1 class="page-title">ğŸ’³ ç»“ç®—ä¸æ”¯ä»˜</h1>

    <!-- æ”¶è´§ä¿¡æ¯ -->
    <section class="glass-card">
      <h3>æ”¶è´§ä¿¡æ¯</h3>
      <form id="checkout-form" class="form-grid">
        <div class="form-group">
          <label class="form-label">å§“å</label>
          <input type="text" id="name" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">è”ç³»ç”µè¯</label>
          <input type="text" id="phone" class="form-input" required>
        </div>
        <div class="form-group full">
          <label class="form-label">æ”¶è´§åœ°å€</label>
          <input type="text" id="address" class="form-input" required>
        </div>
      </form>
    </section>

    <!-- ä¼˜æƒ åˆ¸é€‰æ‹© -->
    <section class="glass-card">
      <h3>ä¼˜æƒ åˆ¸ <small style="font-size:.875rem;font-weight:400;">ï¼ˆå·²è‡ªåŠ¨æ¨èæœ€ä¼˜æƒ ï¼‰</small></h3>
      <div id="coupon-list" class="coupon-selector">
        <!-- JS åŠ¨æ€ç”Ÿæˆ -->
      </div>
    </section>

    <!-- è®¢å•æ‘˜è¦ -->
    <section class="glass-card">
      <h3>è®¢å•æ‘˜è¦</h3>
      <div id="order-items" class="space-y-2">
        <!-- JS åŠ¨æ€å¡«å…… -->
      </div>
      <div class="order-total">
        åˆ¸ååˆè®¡ï¼š<span class="total-price" id="checkout-total">Â¥0.00</span>
      </div>
    </section>

    <!-- æäº¤æŒ‰é’® -->
    <div class="btn-center">
      <button id="submit-order" class="btn-primary">æäº¤è®¢å•å¹¶æ”¯ä»˜</button>
    </div>
  </main>

  <!-- é¡µè„š -->
  <footer class="footer">
    Â© 2025 æœè£…ç®¡ç†ç³»ç»Ÿ | ç»“ç®—é¡µé¢
  </footer>

  <script>
    /* ========== æ•°æ®å±‚ ========== */
    const COUPONS = [
      {id:1,name:'æ–°äººç«‹å‡ Â¥20',type:'fixed',value:20,threshold:0},
      {id:2,name:'æ»¡ Â¥200 å‡ Â¥30',type:'fixed',value:30,threshold:200},
      {id:3,name:'æ»¡ Â¥300 å‡ Â¥50',type:'fixed',value:50,threshold:300},
      {id:4,name:'å…¨åœº 9 æŠ˜',type:'percent',value:0.9,threshold:0},
      {id:5,name:'æ»¡ Â¥500 æ‰“ 8 æŠ˜',type:'percent',value:0.8,threshold:500}
    ];

    /* ========== å·¥å…·å‡½æ•° ========== */
    function loadCart(){return JSON.parse(localStorage.getItem('fashionCart')||'[]');}
    function saveCart(cart){localStorage.setItem('fashionCart',JSON.stringify(cart));}
    function calcOriginTotal(cart){
      return cart.reduce((s,i)=>s+i.price*i.quantity,0);
    }
    function pickBestCoupon(total){
      let best=null,maxSave=0;
      COUPONS.forEach(c=>{
        if(total<c.threshold) return;
        const save=c.type==='fixed'?c.value:(total*(1-c.value));
        if(save>maxSave){maxSave=save;best=c;}
      });
      return best;
    }

    /* ========== æ¸²æŸ“è®¢å• & ä¼˜æƒ åˆ¸ ========== */
    let selectedCoupon=null;
    function render(){
      const cart=loadCart();
      const orderBox=document.getElementById('order-items');
      const couponBox=document.getElementById('coupon-list');
      if(!cart.length){
        orderBox.innerHTML='<p class="text-gray-600">è´­ç‰©è½¦ä¸ºç©ºï¼Œ<a href="index.html" class="text-pink-500">å»é€‰è´­</a></p>';
        couponBox.innerHTML='';
        document.getElementById('checkout-total').textContent='Â¥0.00';
        return;
      }
      const originTotal=calcOriginTotal(cart);
      const best=pickBestCoupon(originTotal);
      selectedCoupon=best;

      /* è®¢å•æ‘˜è¦ */
      orderBox.innerHTML=cart.map(i=>`
        <div class="order-item">
          <div class="flex items-center gap-3">
            <img src="${i.image}" alt="${i.name}" class="w-12 h-12 object-cover rounded">
            <div>
              <div class="font-medium">${i.name}</div>
              <div class="text-sm text-gray-600">æ•°é‡ï¼š${i.quantity}</div>
            </div>
          </div>
          <div class="font-bold text-pink-500">Â¥${(i.price*i.quantity).toFixed(2)}</div>
        </div>
      `).join('');

      /* ä¼˜æƒ åˆ¸åˆ—è¡¨ */
      couponBox.innerHTML=COUPONS.map(c=>`
        <label class="coupon-radio">
          <input type="radio" name="coupon" value="${c.id}" ${c.id===best?.id?'checked':''} onchange="changeCoupon(${c.id})">
          <div class="coupon-info">
            <span class="coupon-name">${c.name}</span>
            <span class="coupon-discount">
              ${c.type==='fixed'?`å‡Â¥${c.value}`:`${(c.value*10)}æŠ˜`}
              ${c.threshold?`ï¼ˆæ»¡Â¥${c.threshold}ï¼‰`:''}
            </span>
          </div>
        </label>
      `).join('');

      updateTotal();
    }

    function changeCoupon(id){
      selectedCoupon=COUPONS.find(c=>c.id===id);
      updateTotal();
    }

    function updateTotal(){
      const cart=loadCart();
      const origin=calcOriginTotal(cart);
      let final=origin;
      if(selectedCoupon){
        if(selectedCoupon.type==='fixed') final=Math.max(0,origin-selectedCoupon.value);
        else final=origin*selectedCoupon.value;
      }
      document.getElementById('checkout-total').textContent=`Â¥${final.toFixed(2)}`;
    }

    /* ========== æäº¤è®¢å• ========== */
    document.getElementById('submit-order').addEventListener('click',()=>{
      const form=document.getElementById('checkout-form');
      if(!form.checkValidity()) return form.reportValidity();
      const cart=loadCart();
      if(!cart.length) return alert('è´­ç‰©è½¦ä¸ºç©ºï¼');
      const origin=calcOriginTotal(cart);
      let final=origin;
      if(selectedCoupon){
        if(selectedCoupon.type==='fixed') final=Math.max(0,origin-selectedCoupon.value);
        else final=origin*selectedCoupon.value;
      }
      const order={
        id:Date.now(),
        items:cart,
        originTotal:origin,
        finalTotal:final,
        coupon:selectedCoupon,
        info:{
          name:document.getElementById('name').value.trim(),
          phone:document.getElementById('phone').value.trim(),
          address:document.getElementById('address').value.trim()
        },
        createAt:new Date().toISOString()
      };
      const orders=JSON.parse(localStorage.getItem('fashionOrders')||'[]');
      orders.push(order);
      localStorage.setItem('fashionOrders',JSON.stringify(orders));
      localStorage.removeItem('fashionCart');
      alert('è®¢å•æäº¤æˆåŠŸï¼');
      location.href='order.html';
    });

    /* ========== åˆå§‹åŒ– ========== */
    document.addEventListener('DOMContentLoaded',render);
  </script>
</body>
</html>